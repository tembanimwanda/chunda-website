<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Admin Dashboard | Booth Management</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"/>

<style>
*{box-sizing:border-box;font-family:Segoe UI,Arial;margin:0;padding:0}
body{background:#f4f6f8;padding:20px;color:#333}

/* ===== BACK BUTTON ===== */
.back-btn{
  display:inline-flex;align-items:center;gap:8px;
  background:#34495e;color:#fff;padding:10px 16px;
  border-radius:12px;text-decoration:none;font-weight:bold;
  margin-bottom:20px;cursor:pointer;
}
.back-btn:hover{opacity:.9}

/* ===== STATS ===== */
.stats{display:grid;grid-template-columns:repeat(auto-fit,minmax(140px,1fr));gap:15px;margin-bottom:25px}
.stat-card{background:#fff;padding:20px;border-radius:18px;text-align:center;box-shadow:0 10px 25px rgba(0,0,0,.1);transition:0.3s;}
.stat-card h3{font-size:28px;margin-bottom:5px}
.stat-card.available h3{color:#2ecc71}
.stat-card.occupied h3{color:#e74c3c}
.stat-card.total h3{color:#3498db}

/* ===== TABLES ===== */
table{width:100%;border-collapse:collapse;background:#fff;border-radius:12px;overflow:hidden;box-shadow:0 10px 20px rgba(0,0,0,.1);margin-bottom:30px}
th,td{padding:12px;text-align:left;font-size:14px}
th{background:#1abc9c;color:#fff}
tr:nth-child(even){background:#f2f6f9}
.status{padding:4px 10px;border-radius:12px;font-weight:bold;font-size:12px}
.Available{background:#2ecc71;color:#fff}
.Occupied{background:#e74c3c;color:#fff}
.Pending{background:#f1c40f;color:#000}
.Approved{background:#2ecc71;color:#fff}
.Rejected{background:#e74c3c;color:#fff}

/* ===== BUTTONS ===== */
button{border:none;padding:6px 12px;border-radius:10px;cursor:pointer;font-size:12px;margin-right:5px}
.approve{background:#2ecc71;color:#fff}
.reject{background:#e74c3c;color:#fff}
.delete{background:#34495e;color:#fff}
.delete:hover{background:#c0392b}

/* ===== MOBILE ===== */
@media(max-width:600px){
  th,td{font-size:13px}
  button{margin-bottom:5px;width:100%}
}
</style>
</head>

<body>

<!-- ===== BACK BUTTON ===== -->
<div class="back-btn" onclick="history.back()"><i class="fas fa-arrow-left"></i> Back</div>

<!-- ===== STATS ===== -->
<div class="stats">
  <div class="stat-card total">
    <h3 id="totalBooths">0</h3>
    <p>Total Booths</p>
  </div>
  <div class="stat-card available">
    <h3 id="availableBooths">0</h3>
    <p>Available</p>
  </div>
  <div class="stat-card occupied">
    <h3 id="occupiedBooths">0</h3>
    <p>Occupied</p>
  </div>
</div>

<!-- ===== VENDOR APPLICATIONS ===== -->
<h2>Vendor Booth Applications</h2>
<table>
<thead>
<tr>
  <th>Vendor</th>
  <th>Business</th>
  <th>Booth</th>
  <th>Location</th>
  <th>Phone</th>
  <th>Status</th>
  <th>Action</th>
</tr>
</thead>
<tbody id="applicationsTable"></tbody>
</table>

<script>
// ===== DATA =====
let applications = JSON.parse(localStorage.getItem("applications") || "[]");
let booths = JSON.parse(localStorage.getItem("booths") || "[]");

// ===== UPDATE STATS =====
function updateStats(){
  let available = 0, occupied = 0;

  booths.forEach(b => {
    if(b.status === "Available") available++;
    if(b.status === "Occupied") occupied++;
  });

  const totalEl = document.getElementById("totalBooths");
  const availEl = document.getElementById("availableBooths");
  const occEl = document.getElementById("occupiedBooths");

  totalEl.innerText = booths.length;
  availEl.innerText = available;
  occEl.innerText = occupied;

  // Optional: highlight numbers dynamically
  totalEl.parentElement.style.boxShadow = `0 0 15px ${booths.length > 0 ? '#3498db' : '#ccc'}`;
  availEl.parentElement.style.boxShadow = `0 0 15px ${available > 0 ? '#2ecc71' : '#ccc'}`;
  occEl.parentElement.style.boxShadow = `0 0 15px ${occupied > 0 ? '#e74c3c' : '#ccc'}`;
}

// ===== RENDER APPLICATIONS =====
function renderApplications(){
  const table = document.getElementById("applicationsTable");
  table.innerHTML = "";

  if(applications.length===0){
    table.innerHTML = "<tr><td colspan='7'>No applications yet</td></tr>";
    updateStats();
    return;
  }

  applications.forEach((app,i)=>{
    table.innerHTML += `
      <tr>
        <td>${app.vendor_name}</td>
        <td>${app.business_name}</td>
        <td>Booth ${app.booth_number}</td>
        <td>${app.location}</td>
        <td>${app.phone}</td>
        <td><span class="status ${app.status}">${app.status}</span></td>
        <td>
          <button class="approve" onclick="approve(${i})">Approve</button>
          <button class="reject" onclick="reject(${i})">Reject</button>
          <button class="delete" onclick="deleteApplication(${i})">Delete</button>
        </td>
      </tr>
    `;
  });

  updateStats();
}

// ===== ACTIONS =====
function approve(i){
  applications[i].status = "Approved";
  const booth = booths.find(b=>b.booth_number==applications[i].booth_number);
  if(booth) booth.status="Occupied";
  saveAll();
}

function reject(i){
  applications[i].status = "Rejected";
  const booth = booths.find(b=>b.booth_number==applications[i].booth_number);
  if(booth) booth.status="Available";
  saveAll();
}

function deleteApplication(i){
  if(!confirm("Delete this application?")) return;
  const booth = booths.find(b=>b.booth_number==applications[i].booth_number);
  if(booth) booth.status="Available";
  applications.splice(i,1);
  saveAll();
}

// ===== SAVE + REFRESH =====
function saveAll(){
  localStorage.setItem("applications", JSON.stringify(applications));
  localStorage.setItem("booths", JSON.stringify(booths));
  renderApplications();
}

// ===== INITIAL LOAD =====
renderApplications();
</script>

</body>
</html>
